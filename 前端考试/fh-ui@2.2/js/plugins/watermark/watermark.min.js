(function (e, t) { if (typeof define === "function" && define.amd) { define([], t()) } else if (typeof module === "object" && module.exports) { module.exports = t() } else { e["watermark"] = t() } })(this, function () { var e = {}; var t = function (e) { var t = { watermark_id: "wm_div_id", watermark_zIndex: "999999", watermark_position: "absolute", watermark_prefix: "mask_div_id", watermark_txt: "代用名 GA0088XX 100.255.255.360", watermark_x: 100, watermark_y: 100, watermark_rows: 0, watermark_cols: 0, watermark_x_space: 80, watermark_y_space: 80, watermark_font: "微软雅黑", watermark_color: "#58728E", watermark_fontsize: "14px", watermark_lineHeight: "40px", watermark_alpha: .3, watermark_width: 320, watermark_height: 135, watermark_angle: 30, watermark_parent_width: 0, watermark_parent_height: 0, watermark_parent_node: null }; if (arguments.length === 1 && typeof arguments[0] === "object") { var a = arguments[0] || {}; for (key in a) { if (a[key] && t[key] && a[key] === t[key]) continue; else if (a[key] || a[key] === 0) t[key] = a[key] } } var r = document.getElementById(t.watermark_id); if (r) { var o = r.parentNode; if (o) { o.removeChild(r) } } var m = Math.max(document.body.scrollWidth, document.body.clientWidth) - t.watermark_width / 2; var w = Math.max(document.body.scrollHeight, document.body.clientHeight, document.documentElement.clientHeight) - t.watermark_height / 2; var i = arguments[0] || {}; var n = t.watermark_parent_node; var _ = 0; var k = 0; if (i.watermark_parent_width || i.watermark_parent_height) { i.watermark_parent_width ? m = i.watermark_parent_width - t.watermark_width / 2 : t.watermark_parent_node ? m = n.offsetWidth - t.watermark_width / 2 : void 0; i.watermark_parent_height ? w = i.watermark_parent_height - t.watermark_height / 2 : t.watermark_parent_node ? w = Math.max(n.offsetHeight, n.scrollHeight) - t.watermark_height / 2 : void 0; if (n) { _ = $(n).offset().top || 0; k = $(n).offset().left || 0; t.watermark_x = t.watermark_x + k; t.watermark_y = t.watermark_y + _ } } else { if (n) { _ = $(n).offset().top || 0; k = $(n).offset().left || 0; m = n.offsetWidth - t.watermark_width / 2 || 0; w = Math.max(n.offsetHeight, n.scrollHeight) - t.watermark_height / 2 || 0; t.watermark_x = t.watermark_x + k; t.watermark_y = t.watermark_y + _ } } var s = document.getElementById(t.watermark_id); var d = null; if (!s) { s = document.createElement("div"); s.id = t.watermark_id; s.setAttribute("class", "wm_div_class"); s.style.pointerEvents = "none"; if (t.watermark_position === "fixed" && !t.watermark_parent_node) { s.style.position = "fixed"; s.style.top = "0"; s.style.left = "0"; s.style.zIndex = t.watermark_zIndex } if (typeof s.createShadowRoot === "function") { d = s.createShadowRoot() } else { d = s } var l = document.body.children; var h = Math.floor(Math.random() * (l.length - 1)); if (l[h]) { document.body.insertBefore(s, l[h]) } else { document.body.appendChild(s) } } else if (s.shadowRoot) { d = s.shadowRoot } if (t.watermark_cols == 0 || parseInt(t.watermark_x + t.watermark_width * t.watermark_cols + t.watermark_x_space * (t.watermark_cols - 1)) > m) { t.watermark_cols = parseInt((m - t.watermark_x + k) / (t.watermark_width + t.watermark_x_space)); t.watermark_x_space = parseInt((m - t.watermark_x + k - t.watermark_width * t.watermark_cols) / (t.watermark_cols - 1)) } if (t.watermark_rows == 0 || parseInt(t.watermark_y + t.watermark_height * t.watermark_rows + t.watermark_y_space * (t.watermark_rows - 1)) > w) { t.watermark_rows = parseInt((w - t.watermark_y + _) / (t.watermark_height + t.watermark_y_space)); t.watermark_y_space = parseInt((w - t.watermark_y + _ - t.watermark_height * t.watermark_rows) / (t.watermark_rows - 1)) } var f; var c; for (var y = 0; y < t.watermark_rows; y++) { c = t.watermark_y + (t.watermark_y_space + t.watermark_height) * y; for (var p = 0; p < t.watermark_cols; p++) { f = t.watermark_x + (t.watermark_width + t.watermark_x_space) * p; var g = document.createElement("div"); var x = document.createTextNode(t.watermark_txt); g.appendChild(x); g.id = t.watermark_prefix + y + p; g.style.webkitTransform = "rotate(-" + t.watermark_angle + "deg)"; g.style.MozTransform = "rotate(-" + t.watermark_angle + "deg)"; g.style.msTransform = "rotate(-" + t.watermark_angle + "deg)"; g.style.OTransform = "rotate(-" + t.watermark_angle + "deg)"; g.style.transform = "rotate(-" + t.watermark_angle + "deg)"; g.style.visibility = ""; g.style.position = "absolute"; g.style.left = f + "px"; g.style.top = c + "px"; g.style.overflow = "hidden"; g.style.zIndex = t.watermark_zIndex; g.style.opacity = t.watermark_alpha; g.style.fontSize = t.watermark_fontsize; g.style.lineHeight = t.watermark_lineHeight; g.style.fontFamily = t.watermark_font; g.style.color = t.watermark_color; g.style.textAlign = "center"; g.style.width = t.watermark_width + "px"; g.style.height = t.watermark_height + "px"; g.style.display = "block"; g.style["-ms-user-select"] = "none"; d.appendChild(g) } } }; e.init = function (e) { window.onload = function () { t(e) }; window.onresize = function () { t(e) }; if (window.addEventListener) { window.addEventListener("DOMContentLoaded", function () { t(e) }) } }; e.load = function (e) { t(e) }; e.destroy = function (e) { if (e === undefined || e === null) { $(".wm_div_class").remove() } else { $("#" + e).remove() } }; this.watermark = e; return e });